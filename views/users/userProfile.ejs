<%-include('../partials/userPartials/userHeader')-%>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
        integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    <section class="login_box_area section_gap mt-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-6">
                    <div class="contact__content">
                        <div class="contact__address mt-5 ml-3">
                            <h5>User Profile</h5>
                            <ul>
                                <li class="mt-5 d-flex">
                                    <h6><i class="fa fa-user text-danger"></i> Name</h6>
                                    <p class="ml-5">
                                        <%=user.name%>
                                    </p>

                                </li>
                                <li class="mt-5 d-flex">
                                    <h6><i class="fa fa-phone text-danger"></i> Phone</h6>
                                    <p class="ml-5"><span>
                                            <%=user.mobile%>
                                        </span></p>
                                </li>
                                <li class="mt-5 d-flex">
                                    <h6><i class="fa fa-envelope text-danger"></i> Email</h6>
                                    <p class="ml-5">
                                        <%=user.email%>
                                    </p>
                                </li>
                                <li class="mt-5 d-flex">
                                    <h6><i class="fa fa-wallet text-danger"></i> Wallet</h6>
                                    <p class="ml-5">
                                        <%=user.wallet%>
                                    </p>
                                </li>
                                <li class="mt-5 d-flex">
                                    <button type="button" class="btn bg-white mt-5 ml-3 text-danger border-warning"
                                        data-toggle="modal" data-target="#exampleModal">
                                        <span class="lnr lnr-file-add"></span>
                                        Add Address
                                    </button>
                                    <button type="button"
                                        class="btn bg-white btn-primary mt-5 ml-3 text-danger border-warning"
                                        data-toggle="modal" data-target="#editProfile">
                                        <span class="lnr lnr-pencil"></span>
                                        Edit profile
                                    </button>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6 ">
                    <div id="reloadDiv">
                        <div class="contact__address mt-5 ml-3">
                            <%if(address.addresses.length> 0){%>
                                <% address.addresses.forEach((value,index)=>{ %>
                                    <div class="bg-white card addresses-item mb-4  shadow ">
                                        <div class="gold-members p-4">
                                            <div class="media">
                                                <div class="mr-3"><i class="icofont-ui-home icofont-3x"></i></div>
                                                <div class="media-body">
                                                    <h6 class="mb-1 "><i
                                                            class="fa fa-map-marker text-danger"></i>Address
                                                        <%=index+1%>
                                                    </h6>
                                                    <p class="text-black">
                                                        <%=value.userName%>, <%= value.address %>, <%= value.city %>,
                                                                    <%= value.state %>, <%= value.pincode %>
                                                                            <div
                                                                                class="col-2 d-flex align-items-center">
                                                                                <span
                                                                                    class="lnr lnr-pencil ml-0"></span>
                                                                                    <a class="ml-2" href=""
                                                                                    class="btn bg-white mt-5 ml-3 text-danger border-warning"
                                                                                    data-toggle="modal" data-target="#editAddressModal<%=index %>">
                                                                                        Edit </a>
                                                                                    
                                                                                <% if(address.addresses.length>1) {%>
                                                                                    <span
                                                                                        class="lnr lnr-trash ml-3"></span>
                                                                                    <a class="ml-2" href=""
                                                                                        onclick="removeAddress('<%=value._id%>')">
                                                                                        Remove </a>
                                                                                    <% } %>


                                                                            </div>
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <%}) %>
                                        <%}else{%>
                                            No Address
                                            <%}%>

                        </div>
                    </div>

                </div>

            </div>
        </div>
    </section>


    <section class="login_box_area section_gap mt-5">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-4">
                    <!-- Modal address-->
                    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog"
                        aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Add address</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <form id="addressForm" class="billing-form" >
                                    <div class="modal-body">
                                        <div class="row align-items-end">
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="name">Name</label>
                                                    <input type="text" class="form-control" id="name" placeholder=""
                                                        name="name" value="<%= user.name %>" >
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="phone">Phone</label>
                                                    <input type="text" class="form-control" id="phone" name="phone"
                                                        value="<%= user.mobile %>">
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="email">email</label>
                                                    <input type="text" class="form-control" id="email" placeholder=""
                                                        name="email" value="<%= user.email %>" >
                                                </div>
                                            </div>
                                            <div class="col-md-12">
                                                <div class="form-group">
                                                    <label for="address">Address</label>
                                                    <input type="text" class="form-control" id="address" placeholder=""
                                                        name="address" >
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="city">City</label>
                                                    <input type="text" class="form-control" id="city" placeholder=""
                                                        name="city" >
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="state">State</label>
                                                    <input type="text" class="form-control" id="state" name="state">
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="pincode">Pincode</label>
                                                    <input type="text" class="form-control" id="pincode" placeholder=""
                                                        name="pincode" >
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button class="btn btn-secondary" data-dismiss="modal">
                                            Close
                                        </button>
                                        <button type="submit" onclick="addAdress()" class="btn btn-primary">Save
                                            changes</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <!-- Modal Edit address-->
                    <% address.addresses.forEach((value,index)=>{ %>
                    <div class="modal fade" id="editAddressModal<%=index %>" tabindex="-1" role="dialog"
                        aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Add address</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <form id="addressForm<%=value._id %>" class="billing-form">
                                    <div class="modal-body">
                                        <div class="row align-items-end">
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="name">Name</label>
                                                    <input type="text" class="form-control" id="name" placeholder=""
                                                        name="name" value="<%=value.userName%>" required>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="phone">Phone</label>
                                                    <input type="text" class="form-control" id="phone" name="phone"
                                                        value="<%= value.mobile %>">
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="email">email</label>
                                                    <input type="text" class="form-control" id="email" placeholder=""
                                                        name="email" value="<%= value.email %>" required>
                                                </div>
                                            </div>
                                            <div class="col-md-12">
                                                <div class="form-group">
                                                    <label for="address">Address</label>
                                                    <input type="text" class="form-control" id="address" placeholder=""
                                                        name="address" value="<%= value.address %>" required>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="city">City</label>
                                                    <input type="text" class="form-control" id="city" placeholder=""
                                                        name="city" value="<%= value.city %>" required>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="state">State</label>
                                                    <input type="text" class="form-control" id="state" name="state" value="<%= value.state %>">
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="pincode">Pincode</label>
                                                    <input type="text" class="form-control" id="pincode" placeholder=""
                                                        name="pincode" value="<%= value.pincode %>" required>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button class="btn btn-secondary" data-dismiss="modal">
                                            Close
                                        </button>
                                        <button type="submit" onclick="editAdress('<%= value._id %>','<%= index%>')" class="btn btn-primary">Save
                                            changes</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <% }) %>

                    <!-- Modal profile-->
                    <div class="modal fade" id="editProfile" tabindex="-1" role="dialog"
                        aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">edit prifile</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form action="/editProfile" class="billing-form" method="post">
                                        <div class="row align-items-end">
                                            <div class="col-12">
                                                <div class="form-group">
                                                    <label for="firstname">Name</label>
                                                    <input type="text" class="form-control" placeholder=""
                                                        value="<%=user.name%>" name="name" />
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="phone">Phone</label>
                                                    <input type="text" class="form-control" placeholder=""
                                                        value="<%=user.number%>" name="phone" required />
                                                </div>
                                            </div>
                                            <div class="col-12">
                                                <div class="form-group">
                                                    <label for="firstname">Email</label>
                                                    <input type="email" class="form-control" placeholder=""
                                                        value="<%=user.email%>" name="email" required />
                                                </div>
                                            </div>
                                        </div>
                                </div>
                                <div class="modal-footer">
                                    <button class="btn btn-secondary" data-dismiss="modal">
                                        Close
                                    </button>
                                    <button type="submit" class="btn btn-primary">Save changes</button>
                                </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>



    <script>
        let name = document.getElementById("name")
        let email = document.getElementById("email")
        let password = document.getElementById("password")
        let number = document.getElementById("number")

        name.addEventListener("input", () => {
            if (name.value.trim() == '') {
                name.setCustomValidity("name cannot be null")
            } else if (name.value.trim().length < 4) {
                name.setCustomValidity("minimum 4 letters required")

            }
            else {
                name.setCustomValidity("")
            }
        })


        number.addEventListener("input", () => {
            if (number.value.trim() == '') {
                number.setCustomValidity("number cannot be null")
            } else if (number.value.trim().length < 10) {
                number.setCustomValidity("minimum 10 letters required")

            }
            else if (number.value.trim().length > 10) {
                number.setCustomValidity("maximum 10 letters required")

            }
            else {
                number.setCustomValidity("")
            }
        })


        email.addEventListener("input", () => {
            if (email.value.trim() == '') {
                email.setCustomValidity("email cannot be null")
            } else if (email.value.trim().length <= 4) {
                email.setCustomValidity("minimum 4 letters required")

            }
            else {
                email.setCustomValidity("")
            }
        })

        password.addEventListener("input", () => {
            if (password.value.trim() == '') {
                password.setCustomValidity("password cannot be null")
            } else if (password.value.trim().length < 6) {
                password.setCustomValidity("minimum 5 letters required")

            }

            else {
                password.setCustomValidity("")
            }
        })


    </script>

    <%-include('../partials/userPartials/userFooter')-%>